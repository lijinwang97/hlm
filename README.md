# hlm
## 模块化架构
1. 项目分为几个独立的模块，每个模块负责不同的功能。目前模块包括：输入模块、处理模块、输出模块、控制模块。
2. 每个模块的功能暂时拟定如下，后续会持续迭代升级。
### 输入模块
1. 支持多种输入源，例如网络流（RTMP、HLS 等）、本地文件（MP4、WebM）等。
2. 提供解码器接口，使用 FFmpeg API 或者其他解码库来处理音视频流。
### 处理模块
1. 截图功能：提取视频流中的某个帧，保存为图片文件（如 PNG 或 JPEG）。
2. 录像功能：实现录制音视频流，保存为指定格式（如 MP4、HLS），支持自定义录制参数（分段时长、保存目录等）。
3. 混流功能：合并多个音视频流，支持调整视频布局、音频混合等。
### 输出模块
1. 将处理后的内容输出到文件或推流到网络服务器（如 SRS、Wowza）。
2. 支持不同的输出格式，如 MP4、HLS、RTMP 推流。
### 控制模块
1. 提供一个接口来控制输入、处理、输出的流程，如开始、暂停、停止录制，动态调整录制参数等。
2. 支持多线程/异步处理，以便高效处理音视频流和响应控制命令。
## 技术栈
1. FFmpeg：解码、编码、格式转换等底层多媒体处理。
2. 多线程：例如使用 C++11 的 std::thread 或其他线程库，确保在处理输入、截图、混流、录制等任务时不会阻塞主线程，后续改为ThreadPool 线程库。
3. 日志库：使用 spdlog日志库记录项目运行情况。
4. 配置管理：使用 TOML 格式管理项目配置文件，如录制参数、混流设置等。
## 设计考虑
1. 性能优化：在处理多路音视频时，可能需要使用硬件加速（如 GPU 编码）来提高性能。
2. 可扩展性：设计时要考虑项目的扩展性，以便后续可以轻松添加新的功能，如水印、滤镜等。
